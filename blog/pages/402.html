<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html><body><div class="post-inner-content">
		<header class="entry-header page-header"><h1 class="entry-title ">&#1055;&#1088;&#1080;&#1084;&#1077;&#1088; &#1086;&#1090;&#1095;&#1077;&#1090;&#1072; &#1089;&#1086;&#1079;&#1076;&#1072;&#1085;&#1085;&#1086;&#1075;&#1086; &#1089; &#1087;&#1086;&#1084;&#1086;&#1097;&#1100;&#1102; as_xlsx</h1>


<!-- .entry-meta -->
		</header><!-- .entry-header --><div class="entry-content">
			<p><a href="/uploads/2013/11/Report1.png"><img class="aligncenter size-medium wp-image-403" title="Report1" src="/uploads/2013/11/Report1-300x91.png" alt="" width="300" height="91"></a></p>
<pre class="lang:plsql">
declare
iNUM integer:=1;
nTOTAL_SUMM number:=0;
sDATE varchar2(100);
begin
as_xlsx.clear_workbook;
as_xlsx.new_sheet('&#1072;&#1074;&#1090;&#1086;&#1079;&#1072;&#1084;&#1077;&#1088;&#1099;');

/* &#1096;&#1080;&#1088;&#1080;&#1085;&#1072; &#1082;&#1086;&#1083;&#1086;&#1085;&#1086;&#1082; */
as_xlsx.set_column_width(1, 36);
as_xlsx.set_column_width(2, 26);
as_xlsx.set_column_width(3, 10);
as_xlsx.set_column_width(4, 10);
as_xlsx.set_column_width(5, 10);
as_xlsx.set_column_width(6, 30);
as_xlsx.set_column_width(7, 13);
as_xlsx.set_column_width(8, 13);
as_xlsx.set_column_width(9, 18);

/* &#1079;&#1072;&#1075;&#1086;&#1083;&#1086;&#1074;&#1086;&#1082; */
as_xlsx.set_row( iNUM, p_fontId =&gt; as_xlsx.get_font( 'Times New Roman', p_fontsize =&gt;14, p_bold =&gt; true ) ) ;
as_xlsx.cell( 1, iNUM, '&#1057;&#1086;&#1089;&#1090;&#1086;&#1103;&#1085;&#1080;&#1077; &#1072;&#1074;&#1090;&#1086;&#1079;&#1072;&#1084;&#1077;&#1088;&#1086;&#1074; &#1087;&#1086;&nbsp; &#1054;&#1054;&#1054; "&#1087;&#1088;&#1086;&#1076;&#1091;&#1082;&#1090;"', p_alignment =&gt; as_xlsx.get_alignment( p_horizontal =&gt; 'center' ) );
as_xlsx.mergecells( 1, iNUM, 9, iNUM );

/* &#1076;&#1072;&#1090;&#1072; &#1089; &#1086;&#1073;&#1098;&#1077;&#1076;&#1080;&#1085;&#1077;&#1085;&#1080;&#1077;&#1084; &#1089;&#1090;&#1088;&#1086;&#1082;*/
select '&#1087;&#1086; &#1089;&#1086;&#1089;&#1090;&#1086;&#1103;&#1085;&#1080;&#1102; &#1085;&#1072; ' || to_char(sysdate+1/12, 'dd.mm.yyyy hh24:mi') into sDATE from DUAL;
iNUM:=iNUM+1;
as_xlsx.cell(1, iNUM, sDATE, p_fontId =&gt; as_xlsx.get_font( 'Times New Roman', p_fontsize =&gt;14 ), p_alignment =&gt; as_xlsx.get_alignment( p_horizontal =&gt; 'center' ));
as_xlsx.mergecells( 1, iNUM, 9, iNUM );

/* &#1087;&#1091;&#1089;&#1090;&#1072;&#1103; &#1089;&#1090;&#1088;&#1086;&#1082;&#1072; */
iNUM:=iNUM+1;
as_xlsx.cell(1, iNUM, '');

/* &#1096;&#1072;&#1087;&#1082;&#1072; &#1090;&#1072;&#1073;&#1083;&#1080;&#1094;&#1099; */
iNUM:=iNUM+1;
as_xlsx.set_row( iNUM, p_fontId =&gt; as_xlsx.get_font( 'Times New Roman', p_fontsize =&gt;10 ),
p_fillId =&gt; as_xlsx.get_fill( 'solid', 'FFFF99' ),
p_borderId =&gt; as_xlsx.get_border) ;

as_xlsx.cell(1, iNUM, '&#1043;&#1086;&#1083;&#1086;&#1074;&#1085;&#1072;&#1103; &#1086;&#1088;&#1075;&#1072;&#1085;&#1080;&#1079;&#1072;&#1094;&#1080;&#1103;', p_alignment =&gt; as_xlsx.get_alignment( p_horizontal =&gt; 'center', p_vertical =&gt; 'center', p_wraptext =&gt; true ));
as_xlsx.cell(2, iNUM, '&#1053;&#1072;&#1080;&#1084;&#1077;&#1085;&#1086;&#1074;&#1072;&#1085;&#1080;&#1077; &#1040;&#1047;&#1057;', p_alignment =&gt; as_xlsx.get_alignment( p_horizontal =&gt; 'center', p_vertical =&gt; 'center', p_wraptext =&gt; true ));
as_xlsx.cell(3, iNUM, '&#1040;&#1074;&#1090;&#1086;&#1079;&#1072;&#1084;&#1077;&#1088;', p_alignment =&gt; as_xlsx.get_alignment( p_horizontal =&gt; 'center', p_vertical =&gt; 'center', p_wraptext =&gt; true ));
as_xlsx.cell(4, iNUM, '&#1063;&#1072;&#1089;&#1090;&#1080;&#1095;&#1085;&#1099;&#1081; &#1072;&#1074;&#1090;&#1086;&#1079;&#1072;&#1084;&#1077;&#1088;', p_alignment =&gt; as_xlsx.get_alignment( p_horizontal =&gt; 'center', p_vertical =&gt; 'center', p_wraptext =&gt; true ));
as_xlsx.cell(5, iNUM, '&#1055;&#1086;&#1083;&#1085;&#1099;&#1081; &#1072;&#1074;&#1090;&#1086;&#1079;&#1072;&#1084;&#1077;&#1088;', p_alignment =&gt; as_xlsx.get_alignment( p_horizontal =&gt; 'center', p_vertical =&gt; 'center', p_wraptext =&gt; true ));
as_xlsx.cell(6, iNUM, '&#1055;&#1088;&#1080;&#1084;&#1077;&#1095;&#1072;&#1085;&#1080;&#1077; (&#1088;&#1077;&#1079;&#1077;&#1088;&#1074;&#1091;&#1072;&#1088; - &#1087;&#1088;&#1086;&#1076;&#1091;&#1082;&#1090; - &#1089;&#1086;&#1089;&#1090;&#1086;&#1103;&#1085;&#1080;&#1077; &#1082;&#1072;&#1085;&#1072;&#1083;&#1072; - &#1087;&#1086;&#1089;&#1083;&#1077;&#1076;&#1085;&#1103;&#1103; &#1079;&#1072;&#1103;&#1074;&#1082;&#1072;)', p_alignment =&gt; as_xlsx.get_alignment( p_horizontal =&gt; 'center', p_vertical =&gt; 'center', p_wraptext =&gt; true ));
as_xlsx.cell(7, iNUM, '&#1042;&#1089;&#1077;&#1075;&#1086; &#1089;&#1099;&#1088;&#1099;&#1093; &#1079;&#1072;&#1084;&#1077;&#1088;&#1086;&#1074; &#1079;&#1072; 24 &#1095; (&#1088;&#1077;&#1079;&#1077;&#1088;&#1074;&#1091;&#1072;&#1088; - &#1082;&#1086;&#1083;&#1080;&#1095;&#1077;&#1089;&#1090;&#1074;&#1086;)', p_alignment =&gt; as_xlsx.get_alignment( p_horizontal =&gt; 'center', p_vertical =&gt; 'center', p_wraptext =&gt; true ));
as_xlsx.cell(8, iNUM, '&#1053;&#1091;&#1083;&#1077;&#1074;&#1099;&#1093; &#1089;&#1099;&#1088;&#1099;&#1093; &#1079;&#1072;&#1084;&#1077;&#1088;&#1086;&#1074; &#1079;&#1072; 24 &#1095; (&#1088;&#1077;&#1079;&#1077;&#1088;&#1074;&#1091;&#1072;&#1088; - &#1082;&#1086;&#1083;&#1080;&#1095;&#1077;&#1089;&#1090;&#1074;&#1086;)', p_alignment =&gt; as_xlsx.get_alignment( p_horizontal =&gt; 'center', p_vertical =&gt; 'center', p_wraptext =&gt; true ));
as_xlsx.cell(9, iNUM, '&#1055;&#1086;&#1089;&#1083;&#1077;&#1076;&#1085;&#1080;&#1081; &#1079;&#1072;&#1084;&#1077;&#1088; (&#1076;&#1072;&#1090;&#1072; - &#1090;&#1080;&#1087;)', p_alignment =&gt; as_xlsx.get_alignment( p_horizontal =&gt; 'center', p_vertical =&gt; 'center', p_wraptext =&gt; true ));

/* &#1085;&#1091;&#1084;&#1077;&#1088;&#1072;&#1094;&#1080;&#1103; &#1082;&#1086;&#1083;&#1086;&#1085;&#1086;&#1082; */
iNUM:=iNUM+1;
as_xlsx.set_row( iNUM, p_fontId =&gt; as_xlsx.get_font( 'Times New Roman', p_fontsize =&gt;10 ),
p_fillId =&gt; as_xlsx.get_fill( 'solid', 'FFFF99' ),
p_borderId =&gt; as_xlsx.get_border) ;

as_xlsx.cell(1, iNUM, '1', p_alignment =&gt; as_xlsx.get_alignment( p_horizontal =&gt; 'center', p_vertical =&gt; 'center', p_wraptext =&gt; true ));
as_xlsx.cell(2, iNUM, '2', p_alignment =&gt; as_xlsx.get_alignment( p_horizontal =&gt; 'center', p_vertical =&gt; 'center', p_wraptext =&gt; true ));
as_xlsx.cell(3, iNUM, '3', p_alignment =&gt; as_xlsx.get_alignment( p_horizontal =&gt; 'center', p_vertical =&gt; 'center', p_wraptext =&gt; true ));
as_xlsx.cell(4, iNUM, '4', p_alignment =&gt; as_xlsx.get_alignment( p_horizontal =&gt; 'center', p_vertical =&gt; 'center', p_wraptext =&gt; true ));
as_xlsx.cell(5, iNUM, '5', p_alignment =&gt; as_xlsx.get_alignment( p_horizontal =&gt; 'center', p_vertical =&gt; 'center', p_wraptext =&gt; true ));
as_xlsx.cell(6, iNUM, '6', p_alignment =&gt; as_xlsx.get_alignment( p_horizontal =&gt; 'center', p_vertical =&gt; 'center', p_wraptext =&gt; true ));
as_xlsx.cell(7, iNUM, '7', p_alignment =&gt; as_xlsx.get_alignment( p_horizontal =&gt; 'center', p_vertical =&gt; 'center', p_wraptext =&gt; true ));
as_xlsx.cell(8, iNUM, '8', p_alignment =&gt; as_xlsx.get_alignment( p_horizontal =&gt; 'center', p_vertical =&gt; 'center', p_wraptext =&gt; true ));
as_xlsx.cell(9, iNUM, '9', p_alignment =&gt; as_xlsx.get_alignment( p_horizontal =&gt; 'center', p_vertical =&gt; 'center', p_wraptext =&gt; true ));

/* &#1079;&#1072;&#1087;&#1086;&#1083;&#1085;&#1077;&#1085;&#1080;&#1077; &#1090;&#1072;&#1073;&#1083;&#1080;&#1094;&#1099; */
for cur in (select 1 as num, 'test' as name, 123 as s, 1 as summ from dual connect by rownum &lt;=5) loop iNUM:=iNUM+1; nTOTAL_SUMM:=nTOTAL_SUMM+cur.summ; as_xlsx.set_row( iNUM, p_fontId =&gt; as_xlsx.get_font( 'Times New Roman', p_fontsize =&gt;9 ), p_borderId =&gt; as_xlsx.get_border ) ;
as_xlsx.cell( 1, iNUM, cur.num);
as_xlsx.cell( 2, iNUM, cur.name);
as_xlsx.cell( 3, iNUM, cur.s);
as_xlsx.cell( 4, iNUM, cur.summ);
as_xlsx.cell( 5, iNUM, '');
as_xlsx.cell( 6, iNUM, '');
as_xlsx.cell( 7, iNUM, '');
as_xlsx.cell( 8, iNUM, '');
as_xlsx.cell( 9, iNUM, '');
end loop;

/* &#1080;&#1090;&#1086;&#1075;&#1080; 1 */
iNUM:=iNUM+1;
as_xlsx.set_row( iNUM, p_fontId =&gt; as_xlsx.get_font( 'Times New Roman', p_fontsize =&gt;10, p_bold =&gt;true&nbsp; ),
p_fillId =&gt; as_xlsx.get_fill( 'solid', 'CCFFFF' ),
p_borderId =&gt; as_xlsx.get_border) ;
as_xlsx.cell( 1, iNUM, '');
as_xlsx.cell( 2, iNUM, '');
as_xlsx.cell( 3, iNUM, '');
as_xlsx.cell( 4, iNUM, '');
as_xlsx.cell( 5, iNUM, '');
as_xlsx.cell( 6, iNUM, '');
as_xlsx.cell( 7, iNUM, '');
as_xlsx.cell( 8, iNUM, '');
as_xlsx.cell( 9, iNUM, '');

/* &#1080;&#1090;&#1086;&#1075;&#1080; 2 */
iNUM:=iNUM+1;
as_xlsx.set_row( iNUM, p_fontId =&gt; as_xlsx.get_font( 'Times New Roman', p_fontsize =&gt;10, p_bold =&gt;true ),
p_fillId =&gt; as_xlsx.get_fill( 'solid', 'CCFFCC' ),
p_borderId =&gt; as_xlsx.get_border) ;
as_xlsx.cell( 1, iNUM, '&#1048;&#1058;&#1054;&#1043;&#1054;:');
as_xlsx.cell( 2, iNUM, '');
as_xlsx.cell( 3, iNUM, '');
as_xlsx.cell( 4, iNUM, nTOTAL_SUMM);
as_xlsx.cell( 5, iNUM, '');
as_xlsx.cell( 6, iNUM, '');
as_xlsx.cell( 7, iNUM, '');
as_xlsx.cell( 8, iNUM, '');
as_xlsx.cell( 9, iNUM, '');

as_xlsx.save( 'DMPDIR', 'my.xlsx' );

end;
/

</pre>
					</div>
<!-- .entry-content -->

		<!-- .entry-meta --></div></body></html>

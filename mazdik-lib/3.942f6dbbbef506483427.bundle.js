(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{125:function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));var a=s(68),i=s(94);class n extends a.DataTable{constructor(e,t,s,n){var r;super((r=a.ColumnModelGenerator.actionColumn,e.unshift(r),e),t,n),this.pagerCache={},this.settings=new i.a(t),this.clientSide=!1,this.service=s,this.columns.forEach(e=>{e.filterValues&&"string"==typeof e.filterValues&&(e.filterValues=this.service.getOptions.bind(this.service,e.filterValues))})}get filters(){return this.dataFilter.filters}set filters(e){this.dataFilter.filters=e,this.events.emitFilter()}loadItems(){return this.getItems(this.settings.virtualScroll,this.pager.current)}getItems(e=!1,t){if(!0===e&&this.pagerCache[t])return Promise.resolve();this.events.emitLoading(!0),this.setSortMetaGroup();const s={pageMeta:{currentPage:t,perPage:this.pager.perPage},filters:this.dataFilter.filters,sortMeta:this.sorter.sortMeta,globalFilterValue:this.dataFilter.globalFilterValue};return this.service.getItems(s).then(s=>{const a=e?this.rows.concat(s.items):s.items;this.pager.total=e?s._meta.totalCount>a.length?a.length+1:a.length:s._meta.totalCount,this.pager.perPage=s._meta.perPage,this.pagerCache[t]=!0,this.rows=a}).finally(()=>{this.events.emitLoading(!1)})}create(e){this.events.emitLoading(!0),this.service.post(e).then(t=>{this.refreshRowOnSave?this.loadItems():this.addRow(t||e)}).finally(()=>{this.events.emitLoading(!1)})}update(e){this.events.emitLoading(!0),this.service.put(e).then(t=>{this.afterUpdate(e,t)}).finally(()=>{this.events.emitLoading(!1)})}delete(e){this.events.emitLoading(!0),this.service.delete(e).then(t=>{this.deleteRow(e)}).finally(()=>{this.events.emitLoading(!1)})}afterUpdate(e,t){this.refreshRowOnSave?this.refreshRow(e):this.mergeRow(e,t||e)}refreshRow(e){this.events.emitLoading(!0),this.service.getItem(e).then(t=>{this.mergeRow(e,t)}).finally(()=>{this.events.emitLoading(!1)})}clear(){this.rows=[],this.pager.total=0}rowIsValid(e){return!this.columns.some(t=>{const s=t.validate(e[t.name]);return s&&s.length>0})}}},126:function(e,t){},130:function(e,t,s){"use strict";var a=s(68),i=(s(129),s(86),s(93)),n=s(0);class r{constructor(e){this.onClickFunc=e,this.elements=new Map,this.listeners=[]}create(e){const{cell:t}=e,s=document.createElement("button");s.classList.add("dt-button-actions");const a=document.createElement("i");return a.classList.add("dt-icon-actions"),s.append(a),this.addListener({eventName:"click",target:s,handler:this.onClickFunc.bind(this,e)}),this.elements.set(t,s),this.refresh(e),s}destroy(){this.removeEventListeners(),this.elements.forEach(e=>e.remove()),this.elements.clear()}refresh(e){const{table:t,cell:s}=e,a=this.elements.get(s);if(a){const e=t.rowChanged(s.row);Object(n.toggleClass)(a,"cell-changed",e)}}addListener(e){this.listeners.push(e),e.target.addEventListener(e.eventName,e.handler)}removeEventListeners(){this.listeners.forEach(e=>{e.target.removeEventListener(e.eventName,e.handler)})}}class o{static createDynamicFormElements(e){return e.columns.map(t=>new i.a({title:t.title,name:t.name,options:t.options,optionsUrl:t.optionsUrl,type:t.type,validatorFunc:t.validatorFunc,dependsElement:t.dependsColumn,cellTemplate:t.formTemplate?t.formTemplate:t.cellTemplate,hidden:t.formHidden,keyElement:t.keyColumn,disableOnEdit:t.formDisableOnEdit,getOptionsFunc:e.service.getOptions.bind(e.service),multiple:t.multiple,selectPlaceholder:e.messages.selectPlaceholder,searchInputPlaceholder:e.messages.search,selectAllMessage:e.messages.selectAll,cancelMessage:e.messages.cancel,clearMessage:e.messages.clear}))}static getRowViewData(e){return e.columns.map(t=>({key:t.title,value:t.getValueView(e.item)}))}}class d extends HTMLElement{constructor(){super(),this.actionMenu=[],this.listeners=[]}get dataManager(){return this._dataManager}set dataManager(e){this._dataManager=e,this.initLoad(),this.addEventListeners()}connectedCallback(){this.isInitialized||(this.onInit(),this.isInitialized=!0)}disconnectedCallback(){this.removeEventListeners()}onInit(){this.classList.add("datatable-wrapper"),this.toolbar=document.createElement("web-dt-toolbar"),this.append(this.toolbar),this.dt=document.createElement("web-data-table"),this.append(this.dt),this.rowMenu=document.createElement("web-context-menu"),this.append(this.rowMenu),this.modalEditForm=document.createElement("web-modal-edit-form"),this.append(this.modalEditForm)}addEventListeners(){this.listeners=[{eventName:"filter",target:this.dataManager.events.element,handler:this.onFilter.bind(this)},{eventName:"sort",target:this.dataManager.events.element,handler:this.onSort.bind(this)},{eventName:"page",target:this.dataManager.events.element,handler:this.onPage.bind(this)},{eventName:"scroll",target:this.dataManager.events.element,handler:this.onScroll.bind(this)},{eventName:"create",target:this.modalEditForm,handler:this.onCreate.bind(this)},{eventName:"update",target:this.modalEditForm,handler:this.onUpdate.bind(this)},{eventName:"createAction",target:this.toolbar,handler:this.createAction.bind(this)},{eventName:"columnsChanged",target:this.toolbar,handler:this.onColumnsChanged.bind(this)}],this.listeners.forEach(e=>{e.target.addEventListener(e.eventName,e.handler)})}removeEventListeners(){this.listeners.forEach(e=>{e.target.removeEventListener(e.eventName,e.handler)})}initLoad(){const e=this.dataManager.columns.find(e=>e.name===a.ColumnModelGenerator.actionColumn.name);e&&(e.cellTemplate=new r(this.onRowMenuClick.bind(this)),e.headerCellTemplate=new a.HeaderActionRenderer),this.dt.table=this.dataManager,this.initRowMenu(),this.rowMenu.menu=this.actionMenu,this.dataManager.settings.initLoad&&this.dataManager.loadItems(),this.toolbar.table=this.dataManager,this.toolbar.createAction=this.dataManager.settings.crud,this.toolbar.globalFilter=this.dataManager.settings.globalFilter,this.toolbar.exportAction=this.dataManager.settings.exportAction,this.toolbar.clearAllFiltersAction=this.dataManager.settings.clearAllFiltersAction,this.toolbar.columnToggleAction=this.dataManager.settings.columnToggleAction,this.modalEditForm.dynElements=o.createDynamicFormElements(this.dataManager),this.modalEditForm.saveMessage=this.dataManager.messages.save,this.modalEditForm.closeMessage=this.dataManager.messages.close,this.modalEditForm.getViewDataFunc=()=>o.getRowViewData(this.dataManager)}onFilter(){this.dataManager.pager.current=1,this.dataManager.settings.virtualScroll&&(this.dt.setOffsetY(0),this.dataManager.pagerCache={},this.dataManager.clear()),this.dataManager.loadItems()}onSort(){this.dataManager.settings.virtualScroll&&(this.dt.setOffsetY(0),this.dataManager.pager.current=1,this.dataManager.pagerCache={},this.dataManager.clear()),this.dataManager.loadItems()}onPage(){this.dataManager.loadItems()}onScroll(){this.rowMenu.hide()}onRowMenuClick(e,t){const{cell:s}=e,i=s.row,{left:n,top:r}=a.EventHelper.getRowPosition(t,this.dataManager.settings.virtualScroll);this.rowMenuBeforeOpen(i),this.rowMenu.show({originalEvent:t,data:i,left:n,top:r})}rowMenuBeforeOpen(e){const t=this.dataManager.rowChanged(e);let s=this.actionMenu.findIndex(e=>e.id===this.dataManager.messages.revertChanges);if(s>-1&&(this.actionMenu[s].disabled=!t),s=this.actionMenu.findIndex(e=>e.id===this.dataManager.messages.save),s>-1){const a=this.dataManager.rowIsValid(e);this.actionMenu[s].disabled=!t||!a}this.rowMenu.menu=this.actionMenu}initRowMenu(){this.dataManager.settings.singleRowView&&this.actionMenu.push({id:this.dataManager.messages.titleDetailView,label:this.dataManager.messages.titleDetailView,icon:["dt-icon","dt-icon-rightwards"],command:e=>this.viewAction(e)}),this.dataManager.settings.crud&&this.actionMenu.push({id:this.dataManager.messages.titleUpdate,label:this.dataManager.messages.titleUpdate,icon:["dt-icon","dt-icon-pencil"],command:e=>this.updateAction(e)},{id:this.dataManager.messages.refresh,label:this.dataManager.messages.refresh,icon:["dt-icon","dt-icon-refresh"],command:e=>this.dataManager.refreshRow(e)},{id:this.dataManager.messages.revertChanges,label:this.dataManager.messages.revertChanges,icon:["dt-icon","dt-icon-return"],command:e=>this.dataManager.revertRowChanges(e),disabled:!0},{id:this.dataManager.messages.save,label:this.dataManager.messages.save,icon:["dt-icon","dt-icon-ok"],command:e=>this.dataManager.update(e),disabled:!0},{id:this.dataManager.messages.delete,label:this.dataManager.messages.delete,icon:["dt-icon","dt-icon-remove"],command:e=>confirm("Delete ?")?this.dataManager.delete(e):null},{id:this.dataManager.messages.duplicate,label:this.dataManager.messages.duplicate,icon:["dt-icon","dt-icon-plus"],command:e=>this.duplicateAction(e)})}createAction(){this.dataManager.item=new a.Row({}),this.modalEditForm.item=this.dataManager.item,this.modalEditForm.modalTitle=this.dataManager.messages.titleCreate,this.modalEditForm.create()}viewAction(e){this.dataManager.item=e,this.modalEditForm.item=this.dataManager.item,this.modalEditForm.modalTitle=this.dataManager.messages.titleDetailView,this.modalEditForm.view()}updateAction(e){this.dataManager.item=e,this.modalEditForm.item=this.dataManager.item,this.modalEditForm.modalTitle=this.dataManager.messages.titleUpdate,this.modalEditForm.update()}duplicateAction(e){this.dataManager.item=e.clone(),this.modalEditForm.item=this.dataManager.item,this.modalEditForm.modalTitle=this.dataManager.messages.titleCreate,this.modalEditForm.update(!0)}onCreate(e){this.dataManager.create(e.detail)}onUpdate(e){this.dataManager.update(e.detail)}onColumnsChanged(){this.dt.columnsChanged()}}customElements.define("web-crud-table",d)},76:function(e,t,s){"use strict";var a=s(94);s.d(t,"CdtSettings",(function(){return a.a}));var i=s(125);s.d(t,"DataManager",(function(){return i.a}));s(126),s(130)},78:function(e,t,s){"use strict";var a=s(71),i=s(0);class n extends HTMLElement{constructor(){super(),this._menu=[],this.listeners=[]}get menu(){return this._menu}set menu(e){this._menu=e,this.render()}connectedCallback(){this.isInitialized||(this.onInit(),this.isInitialized=!0)}disconnectedCallback(){this.dropdown.removeEventListeners(),this.removeEventListeners()}onInit(){this.listMenu=document.createElement("ul"),this.append(this.listMenu),this.classList.add("dt-context-menu"),this.dropdown=new a.a(this),this.addEventListeners()}addEventListeners(){this.listeners=[{eventName:"open",target:this,handler:this.onOpenChange.bind(this)},{eventName:"resize",target:window,handler:this.onWindowResize.bind(this)},{eventName:"click",target:this.listMenu,handler:this.onClickListMenu.bind(this)}],this.listeners.forEach(e=>{e.target.addEventListener(e.eventName,e.handler)})}removeEventListeners(){this.listeners.forEach(e=>{e.target.removeEventListener(e.eventName,e.handler)})}onWindowResize(){this.dropdown.closeDropdown()}getPositionMenu(e,t){const{height:s,width:a}=this.getHiddenElementOuterSizes(this);return e+a-window.pageXOffset>window.innerWidth&&(e-=a),t+s-window.pageYOffset>window.innerHeight&&(t-=s),{left:e,top:t}}getHiddenElementOuterSizes(e){if(e.offsetParent)return{height:e.offsetHeight,width:e.offsetWidth};e.style.visibility="hidden",e.style.display="block";const t=e.offsetHeight,s=e.offsetWidth;return e.style.display="none",e.style.visibility="visible",{height:t,width:s}}show(e){let t;this.eventArgs=e,Object(i.isBlank)(e.left)||Object(i.isBlank)(e.top)?t=this.getPositionMenu(e.originalEvent.pageX+1,e.originalEvent.pageY+1):(t=this.getPositionMenu(e.left,e.top),this.dropdown.selectContainerClicked=!0),e.originalEvent.preventDefault(),this.top===t.top&&this.left===t.left?this.dropdown.toggleDropdown():(this.top=t.top,this.left=t.left,this.dropdown.closeDropdown(),this.dropdown.openDropdown())}hide(){this.dropdown.closeDropdown()}itemClick(e,t){t.disabled?e.preventDefault():(t.url||e.preventDefault(),t.command&&t.command(this.eventArgs.data),this.dropdown.closeDropdown())}updateStyles(){this.style.left=this.left+"px",this.style.top=this.top+"px",this.style.display=this.dropdown.isOpen&&this.menu.length>0?"block":"none"}onOpenChange(){this.updateStyles()}render(){const e=this.createListContent();this.listMenu.textContent="",this.listMenu.append(...e),this.updateStyles()}createListContent(){const e=[];return this.menu.forEach((t,s)=>{const a=document.createElement("li");t.disabled&&a.classList.add("disabled");const i=document.createElement("a");i.href=t.url||"#",i.textContent=t.label,i.dataset.id=s.toString(),a.append(i);const n=document.createElement("span");n.classList.add("context-menu-sep"),i.prepend(n);const r=document.createElement("i");t.icon&&r.classList.add(...t.icon),i.prepend(r),e.push(a)}),e}getDataId(e){const t="A"===e.tagName?e:e.closest("a");return t&&t.dataset.id?t.dataset.id:null}onClickListMenu(e){const t=this.getDataId(e.target);if(null!=t){const s=parseInt(t,10);this.itemClick(e,this.menu[s])}}}customElements.define("web-context-menu",n)},79:function(e,t){},83:function(e,t,s){"use strict";var a=s(0);class i extends HTMLElement{constructor(){super(),this.headerKeyMessage="Key",this.headerValueMessage="Value",this.reverse=!0,this.listeners=[]}get data(){return this._data}set data(e){this._data=e,this.renderRows()}connectedCallback(){this.isInitialized||(this.onInit(),this.isInitialized=!0)}disconnectedCallback(){this.removeEventListeners()}onInit(){this.renderTable(),this.addEventListeners()}addEventListeners(){this.listeners=[{eventName:"click",target:this.headerKey,handler:this.onClickHeaderKey.bind(this)},{eventName:"click",target:this.headerValue,handler:this.onClickHeaderValue.bind(this)}],this.listeners.forEach(e=>{e.target.addEventListener(e.eventName,e.handler)})}removeEventListeners(){this.listeners.forEach(e=>{e.target.removeEventListener(e.eventName,e.handler)})}renderTable(){const e=document.createElement("table");e.classList.add("dt-detail-view");const t=document.createElement("thead");e.append(t);const s=document.createElement("tr");t.append(s);const a=document.createElement("th");a.textContent="№",s.append(a),this.headerKey=document.createElement("th"),this.headerKey.classList.add("sortable"),this.headerKey.textContent=this.headerKeyMessage,s.append(this.headerKey),this.headerValue=document.createElement("th"),this.headerValue.classList.add("sortable"),this.headerValue.textContent=this.headerValueMessage,s.append(this.headerValue),this.tbody=document.createElement("tbody"),e.append(this.tbody),this.append(e)}renderRows(){const e=this.orderedData?this.orderedData:this.data,t=[];e.forEach((e,s)=>{const a=document.createElement("tr"),i=document.createElement("td");i.textContent=(s+1).toString(),a.append(i);const n=document.createElement("td");n.textContent=e.key,a.append(n);const r=document.createElement("td");r.textContent=e.value,a.append(r),t.push(a)}),this.tbody.innerHTML="",this.tbody.append(...t)}onClickHeaderKey(){this.setOrder("key"),this.renderRows(),this.updateStyles()}onClickHeaderValue(){this.setOrder("value"),this.renderRows(),this.updateStyles()}setOrder(e){this.order===e&&(this.reverse=!this.reverse),this.order=e,this.orderedData=this.orderBy(this.data,this.order,this.reverse)}orderBy(e,t,s){return e&&t?(e.sort((e,s)=>e[t]>s[t]?1:e[t]<s[t]?-1:0),!1===s?e.reverse():e):e}isOrder(e){return this.order===e&&this.reverse}isOrderReverse(e){return this.order===e&&!this.reverse}updateStyles(){Object(a.toggleClass)(this.headerKey,"asc",this.isOrder("key")),Object(a.toggleClass)(this.headerKey,"desc",this.isOrderReverse("key")),Object(a.toggleClass)(this.headerValue,"asc",this.isOrder("value")),Object(a.toggleClass)(this.headerValue,"desc",this.isOrderReverse("value"))}}customElements.define("web-row-view",i)},84:function(e,t){},86:function(e,t,s){"use strict";s(78),s(79)},89:function(e,t,s){"use strict";s(83),s(84)},90:function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));var a=s(0),i=s(68);class n{constructor(){this.url="assets/players.json",this.primaryKeys=["id"],this.dataFilter=new i.DataFilter,this.dataSort=new i.DataSort}getItems(e){const t=e.pageMeta.currentPage;this.dataFilter.filters=e.filters,this.dataFilter.globalFilterValue=e.globalFilterValue,this.dataSort.sortMeta=e.sortMeta;const s=e.pageMeta.perPage;return fetch(this.url).then(e=>e.json()).then(e=>{const i=e||[],n=this.dataFilter.filterRows(i),r=this.dataSort.sortRows(n),o=Object(a.arrayPaginate)(r,t,s);return{items:o,_meta:{totalCount:r.length,pageCount:o.length,currentPage:t,perPage:s}}})}getItem(e){const t={};for(const s of this.primaryKeys)t[s]={value:e[s]};const s={pageMeta:{currentPage:1},filters:t};return this.getItems(s).then(e=>e.items[0])}post(e){return new Promise(t=>{setTimeout(()=>t(e),250)})}put(e){return new Promise(t=>{setTimeout(()=>t(e),250)})}delete(e){return new Promise(t=>{setTimeout(()=>t(e),250)})}getOptions(e,t){return fetch(e).then(e=>e.json()).then(e=>{const s=e.filter(e=>e.parentId===t);return new Promise(e=>{setTimeout(()=>e(s),1e3)})})}}},93:function(e,t,s){"use strict";s.d(t,"a",(function(){return a.a}));s(12);var a=s(77);s(89);class i extends HTMLElement{constructor(){super(),this.item={},this.listeners=[]}set dynElements(e){this.dynamicForm.dynElements=e}set modalTitle(e){this.modalEditFormTitle.textContent=e}set saveMessage(e){this.modalEditFormSave.textContent=e}set closeMessage(e){this.modalEditFormClose.textContent=e}connectedCallback(){this.isInitialized||(this.onInit(),this.isInitialized=!0)}disconnectedCallback(){this.removeEventListeners()}onInit(){const e=(~~(1e3*Math.random())).toString(),t=document.createElement("template");t.innerHTML=function(e){return`\n  <web-modal>\n    <template select="app-modal-header">\n      <span id="modalEditFormTitle${e}">Modal</span>\n    </template>\n    <template select="app-modal-body">\n      <web-dynamic-form></web-dynamic-form>\n      <web-row-view></web-row-view>\n    </template>\n    <template select="app-modal-footer">\n      <button class="dt-button" id="modalEditFormSave${e}">Save</button>\n      <button class="dt-button dt-green" id="modalEditFormClose${e}" style="float: right;">Close</button>\n    </ng-container>\n    </template>\n  </web-modal>\n  `}(e),this.append(t.content.cloneNode(!0)),this.modalEditFormTitle=this.querySelector("#modalEditFormTitle"+e),this.modalEditFormSave=this.querySelector("#modalEditFormSave"+e),this.modalEditFormClose=this.querySelector("#modalEditFormClose"+e),this.modal=this.querySelector("web-modal"),this.dynamicForm=this.querySelector("web-dynamic-form"),this.rowView=this.querySelector("web-row-view"),this.dynamicForm.style.display="none",this.rowView.style.display="none",this.addEventListeners()}addEventListeners(){this.listeners=[{eventName:"valid",target:this.dynamicForm,handler:this.onFormValid.bind(this)},{eventName:"click",target:this.modalEditFormSave,handler:this.onClickSave.bind(this)},{eventName:"click",target:this.modalEditFormClose,handler:this.onClickClose.bind(this)}],this.listeners.forEach(e=>{e.target.addEventListener(e.eventName,e.handler)})}removeEventListeners(){this.listeners.forEach(e=>{e.target.removeEventListener(e.eventName,e.handler)})}onClickSave(){this.isNewItem?this.dispatchEvent(new CustomEvent("create",{detail:this.item})):this.dispatchEvent(new CustomEvent("update",{detail:this.item})),this.modal.hide()}onClickClose(){this.modal.hide()}onFormValid(e){this.modalEditFormSave.disabled=!e.detail}create(){this.rowView.style.display="none",this.dynamicForm.style.display="block",this.modalEditFormSave.style.visibility="visible",this.item={},this.dynamicForm.item=this.item,this.isNewItem=!0,this.modal.show()}update(e=!1){this.rowView.style.display="none",this.dynamicForm.style.display="block",this.modalEditFormSave.style.visibility="visible",this.dynamicForm.item=this.item,this.isNewItem=e,this.modal.show()}view(){this.rowView.style.display="block",this.dynamicForm.style.display="none",this.modalEditFormSave.style.visibility="hidden",this.rowView.data=this.getViewDataFunc?this.getViewDataFunc():this.getData(),this.modal.show()}getData(){return Object.keys(this.item).map(e=>({key:e,value:this.item[e]}))}}customElements.define("web-modal-edit-form",i)},94:function(e,t,s){"use strict";s.d(t,"a",(function(){return i}));var a=s(68);class i extends a.Settings{constructor(e){super(e),this.initLoad=!0,this.singleRowView=!0,this.clearAllFiltersIcon=!0,Object.assign(this,e)}}}}]);
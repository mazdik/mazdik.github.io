(window.webpackJsonp=window.webpackJsonp||[]).push([[50],{66:function(e,t,s){"use strict";s.r(t),s.d(t,"getNames",(function(){return d})),s.d(t,"ArrayToStringPipe",(function(){return o})),s.d(t,"default",(function(){return r}));var n=s(80),i=(s(79),s(94)),l=s(0),a=s(71);class c{constructor(e,t,s,n){this.selectList=e,this.options=t,this.columnIndex=s,this.getNames=n,this.elements=new Map,this.inputs=new Map,this.icons=new Map,this.listeners=[],this.globalListeners=[],this._isOpen=!1,this.updateStyleSelectList(),this.addGlobalListener({eventName:"selectionChange",target:this.selectList,handler:this.onSelectionChange.bind(this)}),this.addGlobalListener({eventName:"selectionCancel",target:this.selectList,handler:this.onSelectionCancel.bind(this)}),this.addGlobalListener({eventName:"click",target:window,handler:this.onClickWindow.bind(this)})}get isOpen(){return this._isOpen}set isOpen(e){this._isOpen=e,this.selectList.isOpen=this.isOpen,this.updateStyleSelectList()}create(e){const{cell:t,table:s}=e,n=document.createElement("div");n.classList.add("multi-select-cell");const i=document.createElement("span");i.classList.add("view-data"),i.textContent=t.viewValue,n.append(i);const l=document.createElement("div");l.classList.add("dt-input-group","display-none"),n.append(l);const a=document.createElement("input");a.classList.add("dt-input","dt-select-input"),a.readOnly=!0,a.placeholder="Select",l.append(a);const c=document.createElement("button");c.classList.add("dt-button","dt-white"),l.append(c);const d=document.createElement("i");return d.classList.add("dt-icon","desc"),c.append(d),this.addListener({eventName:"cell",target:s.events.element,handler:this.onCell.bind(this,e)}),this.addListener({eventName:"click",target:l,handler:this.onClick.bind(this,e)}),this.elements.set(t,n),this.inputs.set(t,a),this.icons.set(t,d),this.refresh(e),n}destroy(){this.removeEventListeners(),this.elements.forEach(e=>e.remove()),this.elements.clear()}refresh(e){this.updateStyleSelectList()}addListener(e){this.listeners.push(e),e.target.addEventListener(e.eventName,e.handler)}addGlobalListener(e){this.globalListeners.push(e),e.target.addEventListener(e.eventName,e.handler)}removeEventListeners(){this.listeners.forEach(e=>{e.target.removeEventListener(e.eventName,e.handler)})}removeGlobalEventListeners(){this.globalListeners.forEach(e=>{e.target.removeEventListener(e.eventName,e.handler)})}updateEditing(e,t){const s=this.elements.get(e);if(s){const e=s.firstElementChild,n=s.lastElementChild;Object(l.toggleClass)(e,"display-none",t),Object(l.toggleClass)(n,"display-none",!t)}}onCell(e,t){const{cell:s}=e,n=t.detail;if(n.type===a.CellEventType.Click){const e=n.columnIndex===this.columnIndex&&n.rowIndex===s.rowIndex;this.isOpen=!1,this.updateEditing(s,e),e&&(this.selectedCell=s)}}onClick(e,t){const{cell:s,table:n}=e;t.stopPropagation(),this.isOpen=!this.isOpen;const i=this.icons.get(s);i&&(Object(l.toggleClass)(i,"asc",this.isOpen),Object(l.toggleClass)(i,"desc",!this.isOpen));const c=a.EventHelper.getRowPosition(t,n.settings.virtualScroll);this.selectList.model=s.value||[],this.selectList.style.left=c.left+"px",this.selectList.style.top=c.top+"px"}updateSelectedName(e){const t=this.getNames(e.value,this.options);this.inputs.get(e).value=t;this.elements.get(e).firstElementChild.textContent=t}updateStyleSelectList(){this.selectList.style.display=this.isOpen?"block":"none"}onSelectionChange(e){this.selectedCell.value=e.detail,this.updateSelectedName(this.selectedCell),this.isOpen=!1}onSelectionCancel(){this.isOpen=!1}onClickWindow(e){if(!Object(l.findAncestor)(e.target,".datatable-body-cell")){Object(l.findAncestor)(e.target,".dt-dropdown-select-list")||(this.isOpen=!1,this.updateEditing(this.selectedCell,!1))}}}function d(e,t){if(e&&e.length&&t&&t.length){if(e.length>1)return e.length+" items selected";{const s=t.find(t=>t.id===e[0]);return s?s.name:""}}return""}class o{constructor(e){this.options=e}transform(e){return e?d(e,this.options):e}}class r{get template(){return'<div class="multi-select-demo-block">\n      <web-select-list class="dt-dropdown-select-list"></web-select-list>\n      <web-crud-table class="multi-select-demo"></web-crud-table>\n    </div>'}load(){const e=[{id:"1",name:"Select 1"},{id:"2",name:"Select 2"},{id:"3",name:"Select 3"},{id:"4",name:"Select 4"}],t=document.querySelector("web-select-list");t.settings={multiple:!0},t.options=e;const s=document.querySelector("web-crud-table");this.cellMultiSelectRenderer=new c(t,e,1,d);const l=[{title:"Test",name:"test",width:250,type:"select-dropdown",multiple:!0,options:e,cellTemplate:this.cellMultiSelectRenderer,pipe:new o(e)},{title:"Id",name:"id"},{title:"Name",name:"name"},{title:"Race",name:"race"},{title:"Gender",name:"gender"}],a=new n.CdtSettings({crud:!0}),r=new i.a,h=new n.DataManager(l,a,r);s.dataManager=h}onDestroy(){this.cellMultiSelectRenderer.removeGlobalEventListeners()}}}}]);
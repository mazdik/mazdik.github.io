(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{110:function(t,e,s){"use strict";s.d(e,"a",(function(){return a}));var i=s(0),n=s(65);class a{constructor(){this.url="assets/players.json",this.primaryKeys=["id"],this.dataFilter=new n.DataFilter,this.dataSort=new n.DataSort}getItems(t){const e=t.pageMeta.currentPage;this.dataFilter.filters=t.filters,this.dataFilter.globalFilterValue=t.globalFilterValue,this.dataSort.sortMeta=t.sortMeta;const s=t.pageMeta.perPage;return fetch(this.url).then(t=>t.json()).then(t=>{const n=t||[],a=this.dataFilter.filterRows(n),r=this.dataSort.sortRows(a),o=Object(i.arrayPaginate)(r,e,s);return{items:o,_meta:{totalCount:r.length,pageCount:o.length,currentPage:e,perPage:s}}})}getItem(t){const e={};for(const s of this.primaryKeys)e[s]={value:t[s]};const s={pageMeta:{currentPage:1},filters:e};return this.getItems(s).then(t=>t.items[0])}post(t){return new Promise(e=>{setTimeout(()=>e(t),250)})}put(t){return new Promise(e=>{setTimeout(()=>e(t),250)})}delete(t){return new Promise(e=>{setTimeout(()=>e(t),250)})}getOptions(t,e){return fetch(t).then(t=>t.json()).then(t=>{const s=t.filter(t=>t.parentId===e);return new Promise(t=>{setTimeout(()=>t(s),1e3)})})}}},114:function(t,e,s){"use strict";var i=s(0),n=s(85);class a extends HTMLElement{constructor(){super(),this.sourceElements=[],this.targetElements=[],this.listeners=[]}set sourceTitle(t){this.sourceList.previousSibling.textContent=t}set targetTitle(t){this.targetList.previousSibling.textContent=t}get source(){return this._source}set source(t){this._source=t}get target(){return this._target}set target(t){this._target=t,this.createSourceElements(),this.createTargetElements(),this.renderLists()}connectedCallback(){this.isInitialized||(this.onInit(),this.isInitialized=!0)}disconnectedCallback(){this.removeEventListeners(),this.dragDrop.destroy()}onInit(){const t=(~~(1e3*Math.random())).toString(),e=document.createElement("template");e.innerHTML=function(t){return`\n<div class="dt-listbox-panel">\n  <label></label>\n  <div class="dt-list-menu" id="sourceList${t}"></div>\n</div>\n<div class="dt-listbox-panel">\n  <button class="dt-button" id="moveRightAllButton${t}" title="move all to the right">\n    <i class="dt-icon-quotation-r large"></i>\n  </button>\n  <button class="dt-button" id="moveRightButton${t}" title="move selected to the right">\n    <i class="dt-icon-arrow-right large"></i>\n  </button>\n  <button class="dt-button" id="moveLeftButton${t}" title="move selected to the left">\n    <i class="dt-icon-arrow-left large"></i>\n  </button>\n  <button class="dt-button" id="moveLeftAllButton${t}" title="move all to the left">\n    <i class="dt-icon-quotation-l large"></i>\n  </button>\n</div>\n<div class="dt-listbox-panel">\n  <label></label>\n  <div class="dt-list-menu" id="targetList${t}"></div>\n</div>\n<div class="dt-listbox-panel">\n  <button class="dt-button" id="moveTopButton${t}" title="move top">\n    <i class="dt-icon-tab-up large"></i>\n  </button>\n  <button class="dt-button" id="moveUpButton${t}" title="move up">\n    <i class="dt-icon-arrow-up large"></i>\n  </button>\n  <button class="dt-button" id="moveDownButton${t}" title="move down">\n    <i class="dt-icon-arrow-down large"></i>\n  </button>\n  <button class="dt-button" id="moveBottomButton${t}" title="move bottom">\n    <i class="dt-icon-tab-down large"></i>\n  </button>\n</div>\n  `}(t),this.append(e.content.cloneNode(!0)),this.sourceList=this.querySelector("#sourceList"+t),this.targetList=this.querySelector("#targetList"+t),this.moveRightAllButton=this.querySelector("#moveRightAllButton"+t),this.moveRightButton=this.querySelector("#moveRightButton"+t),this.moveLeftButton=this.querySelector("#moveLeftButton"+t),this.moveLeftAllButton=this.querySelector("#moveLeftAllButton"+t),this.moveTopButton=this.querySelector("#moveTopButton"+t),this.moveUpButton=this.querySelector("#moveUpButton"+t),this.moveDownButton=this.querySelector("#moveDownButton"+t),this.moveBottomButton=this.querySelector("#moveBottomButton"+t),this.classList.add("dt-listbox"),this.dragDrop=new n.DragDrop([this.sourceList,this.targetList],[]),this.addEventListeners()}addEventListeners(){this.listeners=[{eventName:"click",target:this.sourceList,handler:this.onClickSourceList.bind(this)},{eventName:"click",target:this.targetList,handler:this.onClickTargetList.bind(this)},{eventName:"droppableElementChange",target:this.sourceList,handler:this.onDroppableElementChange.bind(this)},{eventName:"droppableElementChange",target:this.targetList,handler:this.onDroppableElementChange.bind(this)},{eventName:"click",target:this.moveRightAllButton,handler:this.moveRightAll.bind(this)},{eventName:"click",target:this.moveRightButton,handler:this.moveRight.bind(this)},{eventName:"click",target:this.moveLeftButton,handler:this.moveLeft.bind(this)},{eventName:"click",target:this.moveLeftAllButton,handler:this.moveLeftAll.bind(this)},{eventName:"click",target:this.moveTopButton,handler:this.moveTop.bind(this)},{eventName:"click",target:this.moveUpButton,handler:this.moveUp.bind(this)},{eventName:"click",target:this.moveDownButton,handler:this.moveDown.bind(this)},{eventName:"click",target:this.moveBottomButton,handler:this.moveBottom.bind(this)}],this.listeners.forEach(t=>{t.target.addEventListener(t.eventName,t.handler)})}removeEventListeners(){this.listeners.forEach(t=>{t.target.removeEventListener(t.eventName,t.handler)})}createSourceElements(){this.source&&this.source.length&&this.target&&this.target.length&&(this._source=this.source.filter(t=>this.target.every(e=>e.id!==t.id))),this.sourceElements=this.createListContent(this._source),this.dragDrop.registerDraggableElements(this.sourceElements)}createTargetElements(){this.targetElements=this.createListContent(this._target),this.dragDrop.registerDraggableElements(this.targetElements)}moveRight(){if(!Object(i.isBlank)(this.sourceModel)&&!Object(i.isBlank)(this.sourceElements)){const t=this.sourceElements.findIndex(t=>t.dataset.id===this.sourceModel);Object(i.arrayTransfer)(this.sourceElements,this.targetElements,t,this.targetElements.length),this.sourceModel=null,this.emitEvent()}}moveRightAll(){Object(i.isBlank)(this.sourceElements)||(this.targetElements=[...this.targetElements,...this.sourceElements],this.sourceElements=[],this.sourceModel=null,this.emitEvent())}moveLeft(){if(!Object(i.isBlank)(this.targetModel)&&!Object(i.isBlank)(this.targetElements)){const t=this.targetElements.findIndex(t=>t.dataset.id===this.targetModel);Object(i.arrayTransfer)(this.targetElements,this.sourceElements,t,this.sourceElements.length),this.targetModel=null,this.emitEvent()}}moveLeftAll(){Object(i.isBlank)(this.targetElements)||(this.targetElements.forEach(t=>this.sourceElements.push(t)),this.targetElements=[],this.targetModel=null,this.emitEvent())}moveUp(){if(!Object(i.isBlank)(this.targetModel)&&this.targetElements.length>1){const t=this.targetElements.findIndex(t=>t.dataset.id===this.targetModel);0!==t&&(Object(i.arrayMove)(this.targetElements,t,t-1),this.targetList.children[t]&&this.targetList.children[t].scrollIntoView({block:"center",behavior:"smooth"}),this.emitEvent())}}moveTop(){if(!Object(i.isBlank)(this.targetModel)&&this.targetElements.length>1){const t=this.targetElements.findIndex(t=>t.dataset.id===this.targetModel);0!==t&&(Object(i.arrayMove)(this.targetElements,t,0),this.targetList.scrollTop=0,this.emitEvent())}}moveDown(){if(!Object(i.isBlank)(this.targetModel)&&this.targetElements.length>1){const t=this.targetElements.findIndex(t=>t.dataset.id===this.targetModel);t!==this.targetElements.length-1&&(Object(i.arrayMove)(this.targetElements,t,t+1),this.targetList.children[t]&&this.targetList.children[t].scrollIntoView({block:"center",behavior:"smooth"}),this.emitEvent())}}moveBottom(){if(!Object(i.isBlank)(this.targetModel)&&this.targetElements.length>1){const t=this.targetElements.findIndex(t=>t.dataset.id===this.targetModel);t!==this.targetElements.length-1&&(Object(i.arrayMove)(this.targetElements,t,this.targetElements.length),this.targetList.scrollTop=this.targetList.scrollHeight,this.emitEvent())}}emitEvent(t=!0){t&&this.renderLists();const e=[...this.source,...this.target],s=this.targetElements.map(t=>e.find(e=>e.id===t.dataset.id));this.dispatchEvent(new CustomEvent("targetChange",{detail:s}))}createListContent(t){const e=[];return t.forEach(t=>{const s=document.createElement("div");s.classList.add("dt-list-menu-item"),s.textContent=t.name,s.dataset.id=t.id,e.push(s)}),e}renderSourceList(){this.sourceList.innerHTML="",this.sourceList.append(...this.sourceElements),this.updateStyles()}renderTargetList(){this.targetList.innerHTML="",this.targetList.append(...this.targetElements),this.updateStyles()}renderLists(){this.renderSourceList(),this.renderTargetList()}onClickSourceList(t){const e=this.getListItemElement(t);e&&(t.stopPropagation(),this.sourceModel=e.dataset.id,this.updateStyles())}onClickTargetList(t){const e=this.getListItemElement(t);e&&(t.stopPropagation(),this.targetModel=e.dataset.id,this.updateStyles())}getListItemElement(t){const e=t.target;return e.classList.contains("dt-list-menu-item")?e:e.closest(".dt-list-menu-item")}updateStyles(){this.sourceElements.forEach(t=>{Object(i.toggleClass)(t,"active",t.dataset.id===this.sourceModel)}),this.targetElements.forEach(t=>{Object(i.toggleClass)(t,"active",t.dataset.id===this.targetModel)});const t=Object(i.isBlank)(this.targetModel);this.moveRightButton.disabled=Object(i.isBlank)(this.sourceModel),this.moveLeftButton.disabled=t,this.moveTopButton.disabled=t,this.moveUpButton.disabled=t,this.moveDownButton.disabled=t,this.moveBottomButton.disabled=t}onDroppableElementChange(){this.sourceElements=Array.from(this.sourceList.children),this.targetElements=Array.from(this.targetList.children),this.sourceModel=null,this.targetModel=null,this.updateStyles(),this.emitEvent(!1)}}customElements.define("web-dual-list-box",a)},122:function(t,e,s){"use strict";s.d(e,"a",(function(){return a}));var i=s(65),n=s(90);class a extends i.DataTable{constructor(t,e,s,a){var r;super((r=i.ColumnModelGenerator.actionColumn,t.unshift(r),t),e,a),this.pagerCache={},this.settings=new n.a(e),this.clientSide=!1,this.service=s,this.columns.forEach(t=>{t.filterValues&&"string"==typeof t.filterValues&&(t.filterValues=this.service.getOptions.bind(this.service,t.filterValues))})}get filters(){return this.dataFilter.filters}set filters(t){this.dataFilter.filters=t,this.events.emitFilter()}loadItems(){return this.getItems(this.settings.virtualScroll)}getItems(t=!1){if(!0===t&&this.pagerCache[this.pager.current])return Promise.resolve();this.events.emitLoading(!0),this.setSortMetaGroup();const e={pageMeta:{currentPage:this.pager.current,perPage:this.pager.perPage},filters:this.dataFilter.filters,sortMeta:this.sorter.sortMeta,globalFilterValue:this.dataFilter.globalFilterValue};return this.service.getItems(e).then(e=>{const s=t?this.rows.concat(e.items):e.items;this.pager.total=t?e._meta.totalCount>s.length?s.length+1:s.length:e._meta.totalCount,this.pager.perPage=e._meta.perPage,this.pagerCache[this.pager.current]=!0,this.rows=s}).finally(()=>{this.events.emitLoading(!1)})}create(t){this.events.emitLoading(!0),this.service.post(t).then(e=>{this.refreshRowOnSave?this.loadItems():this.addRow(e||t)}).finally(()=>{this.events.emitLoading(!1)})}update(t){this.events.emitLoading(!0),this.service.put(t).then(e=>{this.afterUpdate(t,e)}).finally(()=>{this.events.emitLoading(!1)})}delete(t){this.events.emitLoading(!0),this.service.delete(t).then(e=>{this.deleteRow(t)}).finally(()=>{this.events.emitLoading(!1)})}afterUpdate(t,e){this.refreshRowOnSave?this.refreshRow(t):this.mergeRow(t,e||t)}refreshRow(t){this.events.emitLoading(!0),this.service.getItem(t).then(e=>{this.mergeRow(t,e)}).finally(()=>{this.events.emitLoading(!1)})}clear(){this.rows=[],this.pager.total=0}rowIsValid(t){return!this.columns.some(e=>{const s=e.validate(t[e.name]);return s&&s.length>0})}}},123:function(t,e){},126:function(t,e,s){"use strict";var i=s(0),n=s(68);s(12),s(114);class a extends HTMLElement{constructor(){super(),this.listeners=[],this.selectColumns=[],this.selectedColumns=[]}connectedCallback(){this.isInitialized||(this.onInit(),this.isInitialized=!0)}disconnectedCallback(){this.removeEventListeners()}onInit(){const t=(~~(1e3*Math.random())).toString(),e=document.createElement("template");e.innerHTML=function(t){return`\n  <web-modal>\n    <template select="app-modal-header">\n      <span id="modalEditFormTitle${t}">Modal</span>\n    </template>\n    <template select="app-modal-body">\n      <web-dual-list-box></web-dual-list-box>\n    </template>\n    <template select="app-modal-footer">\n      <button class="dt-button" id="modalEditFormSave${t}">Save</button>\n      <button class="dt-button dt-green" id="modalEditFormClose${t}" style="float: right;">Close</button>\n    </ng-container>\n    </template>\n  </web-modal>\n  `}(t),this.append(e.content.cloneNode(!0)),this.modalEditFormTitle=this.querySelector("#modalEditFormTitle"+t),this.modalEditFormSave=this.querySelector("#modalEditFormSave"+t),this.modalEditFormClose=this.querySelector("#modalEditFormClose"+t),this.modal=this.querySelector("web-modal"),this.dualListBox=document.querySelector("web-dual-list-box"),this.addEventListeners()}addEventListeners(){this.listeners=[{eventName:"targetChange",target:this.dualListBox,handler:this.onSelectionChange.bind(this)},{eventName:"click",target:this.modalEditFormSave,handler:this.onClickSave.bind(this)},{eventName:"click",target:this.modalEditFormClose,handler:this.onClickClose.bind(this)}],this.listeners.forEach(t=>{t.target.addEventListener(t.eventName,t.handler)})}removeEventListeners(){this.listeners.forEach(t=>{t.target.removeEventListener(t.eventName,t.handler)})}onSelectionChange(t){this.selectedColumns=t.detail}createSelectItems(){this.selectedColumns=this.table.columns.filter(t=>!t.tableHidden).map(t=>({id:t.name,name:t.title})),this.selectColumns=this.table.columns.map(t=>({id:t.name,name:t.title}))}onClickSave(){this.table.columns.forEach(t=>{t.tableHidden=!0,t.index=99}),this.selectedColumns.forEach((t,e)=>{const s=this.table.columns.findIndex(e=>e.name===t.id);this.table.columns[s].tableHidden=!1,this.table.columns[s].index=e}),this.table.columns.sort((t,e)=>t.index>e.index?1:t.index<e.index?-1:0),this.dispatchEvent(new CustomEvent("columnsChanged")),this.modal.hide()}onClickClose(){this.modal.hide()}open(){this.modalEditFormTitle.textContent=this.table.messages.columns,this.modalEditFormSave.textContent=this.table.messages.save,this.modalEditFormClose.textContent=this.table.messages.close,this.createSelectItems(),this.dualListBox.source=this.selectColumns,this.dualListBox.target=this.selectedColumns,this.modal.show()}}customElements.define("web-dt-column-toggler",a);class r extends HTMLElement{constructor(){super(),this.listeners=[]}get table(){return this._table}set table(t){this._table=t,this.onInitTable()}get globalFilter(){return this._globalFilter}set globalFilter(t){this._globalFilter=t,this.updateStyles()}get createAction(){return this._createAction}set createAction(t){this._createAction=t,this.updateStyles()}get exportAction(){return this._exportAction}set exportAction(t){this._exportAction=t,this.updateStyles()}get columnToggleAction(){return this._columnToggleAction}set columnToggleAction(t){this._columnToggleAction=t,this.updateStyles()}get clearAllFiltersAction(){return this._clearAllFiltersAction}set clearAllFiltersAction(t){this._clearAllFiltersAction=t,this.updateStyles()}connectedCallback(){this.isInitialized||(this.onInit(),this.isInitialized=!0)}disconnectedCallback(){this.dropdown.destroy(),this.removeEventListeners()}onInit(){this.classList.add("dt-toolbar"),this.createWrapper=document.createElement("div"),this.createWrapper.classList.add("dt-toolbar-col"),this.append(this.createWrapper),this.createButton=document.createElement("button"),this.createButton.classList.add("dt-button"),this.createWrapper.append(this.createButton),this.filterWrapper=document.createElement("div"),this.filterWrapper.classList.add("dt-toolbar-col","dt-global-filter"),this.append(this.filterWrapper);const t=document.createElement("div");t.classList.add("dt-input-group"),this.filterWrapper.append(t),this.filterInput=document.createElement("input"),this.filterInput.classList.add("dt-input"),t.append(this.filterInput),this.filterButton=document.createElement("button"),this.filterButton.classList.add("dt-button"),t.append(this.filterButton),this.dropdownWrapper=document.createElement("div"),this.dropdownWrapper.classList.add("dt-toolbar-col"),this.append(this.dropdownWrapper),this.dropdownButton=document.createElement("button"),this.dropdownButton.classList.add("dt-button"),this.dropdownWrapper.append(this.dropdownButton);const e=document.createElement("div");e.classList.add("dt-context-menu"),this.dropdownWrapper.append(e),this.columnToggleMenu=document.createElement("div"),this.columnToggleMenu.classList.add("dt-list-menu-item"),e.append(this.columnToggleMenu),this.exportMenu=document.createElement("div"),this.exportMenu.classList.add("dt-list-menu-item"),e.append(this.exportMenu),this.clearAllFiltersMenu=document.createElement("div"),this.clearAllFiltersMenu.classList.add("dt-list-menu-item"),e.append(this.clearAllFiltersMenu),this.dropdown=new n.b([this.dropdownWrapper]),this.dtColumnToggler=document.createElement("web-dt-column-toggler"),this.append(this.dtColumnToggler),this.updateStyles(),this.addEventListeners()}addEventListeners(){this.listeners=[{eventName:"input",target:this.filterInput,handler:this.onInputGlobalSearch.bind(this)},{eventName:"keypress",target:this.filterInput,handler:this.onKeyPressGlobalSearch.bind(this)},{eventName:"click",target:this.filterButton,handler:this.onClickGlobalSearch.bind(this)},{eventName:"click",target:this.createButton,handler:this.onClickCreateAction.bind(this)},{eventName:"clickElement",target:this.dropdownWrapper,handler:this.onClickDropdown.bind(this)},{eventName:"click",target:this.columnToggleMenu,handler:this.onClickColumnToggleMenu.bind(this)},{eventName:"click",target:this.exportMenu,handler:this.downloadCsv.bind(this)},{eventName:"click",target:this.clearAllFiltersMenu,handler:this.clearAllFilters.bind(this)},{eventName:"columnsChanged",target:this.dtColumnToggler,handler:this.onColumnsChanged.bind(this)}],this.listeners.forEach(t=>{t.target.addEventListener(t.eventName,t.handler)})}removeEventListeners(){this.listeners.forEach(t=>{t.target.removeEventListener(t.eventName,t.handler)})}addListener(t){this.listeners.push(t),t.target.addEventListener(t.eventName,t.handler)}onInitTable(){this.filterInput.placeholder=this.table.messages.search,this.filterInput.value=this.table.dataFilter.globalFilterValue,this.filterButton.textContent=this.table.messages.go,this.createButton.textContent=this.table.messages.create;const t=document.createTextNode(this.table.messages.actions);this.dropdownButton.append(t);const e=document.createElement("i");e.classList.add("dt-icon-node"),this.dropdownButton.append(e),this.columnToggleMenu.textContent=this.table.messages.columns,this.exportMenu.textContent=this.table.messages.export,this.clearAllFiltersMenu.textContent=this.table.messages.clearFilters,this.dtColumnToggler.table=this.table,this.addListener({eventName:"filter",target:this.table.events.element,handler:this.onFilter.bind(this)})}updateStyles(){this.filterWrapper.style.display=this.globalFilter?"block":"none",this.createWrapper.style.display=this.createAction?"block":"none";const t=this.exportAction||this.columnToggleAction||this.clearAllFiltersAction;this.dropdownWrapper.style.display=t?"block":"none",this.columnToggleMenu.style.display=this.columnToggleAction?"block":"none",this.exportMenu.style.display=this.exportAction?"block":"none",this.clearAllFiltersMenu.style.display=this.clearAllFiltersAction?"block":"none"}onInputGlobalSearch(t){this.table.dataFilter.globalFilterValue=t.target.value}onKeyPressGlobalSearch(t){t.which===i.Keys.ENTER&&this.table.events.emitFilter()}onClickGlobalSearch(){this.table.events.emitFilter()}onFilter(){this.filterInput&&(this.filterInput.value=this.table.dataFilter.globalFilterValue)}downloadCsv(){const t=this.table.columns.map(t=>t.name),e=this.table.columns.map(t=>t.title),s=[];this.table.rows.forEach(t=>{const e=t.clone();this.table.columns.forEach(t=>{e[t.name]=t.getValueView(e)}),s.push(e)}),Object(i.downloadCSV)({rows:s,keys:t,titles:e})}onClickCreateAction(){this.dispatchEvent(new CustomEvent("createAction"))}onClickDropdown(){Object(i.toggleClass)(this.clearAllFiltersMenu,"disabled",!this.table.dataFilter.hasFilters())}clearAllFilters(){this.table.dataFilter.hasFilters()&&(this.table.dataFilter.clear(),this.table.events.emitFilter())}onClickColumnToggleMenu(){this.dtColumnToggler.open()}onColumnsChanged(){this.dispatchEvent(new CustomEvent("columnsChanged"))}}customElements.define("web-dt-toolbar",r)},127:function(t,e,s){"use strict";var i=s(65),n=(s(126),s(82),s(89)),a=s(0);class r{constructor(t){this.onClickFunc=t,this.elements=new Map,this.listeners=[]}create(t){const{cell:e}=t,s=document.createElement("button");s.classList.add("dt-button-actions");const i=document.createElement("i");return i.classList.add("dt-icon-actions"),s.append(i),this.addListener({eventName:"click",target:s,handler:this.onClickFunc.bind(this,t)}),this.elements.set(e,s),this.refresh(t),s}destroy(){this.removeEventListeners(),this.elements.forEach(t=>t.remove()),this.elements.clear()}refresh(t){const{table:e,cell:s}=t,i=this.elements.get(s);if(i){const t=e.rowChanged(s.row);Object(a.toggleClass)(i,"cell-changed",t)}}addListener(t){this.listeners.push(t),t.target.addEventListener(t.eventName,t.handler)}removeEventListeners(){this.listeners.forEach(t=>{t.target.removeEventListener(t.eventName,t.handler)})}}class o{static createDynamicFormElements(t){return t.columns.map(e=>new n.a({title:e.title,name:e.name,options:e.options,optionsUrl:e.optionsUrl,type:e.type,validatorFunc:e.validatorFunc,dependsElement:e.dependsColumn,cellTemplate:e.formTemplate?e.formTemplate:e.cellTemplate,hidden:e.formHidden,keyElement:e.keyColumn,disableOnEdit:e.formDisableOnEdit,getOptionsFunc:t.service.getOptions.bind(t.service),selectPlaceholder:t.messages.selectPlaceholder,searchInputPlaceholder:t.messages.search}))}static getRowViewData(t){return t.columns.map(e=>({key:e.title,value:e.getValueView(t.item)}))}}class l extends HTMLElement{constructor(){super(),this.actionMenu=[],this.listeners=[]}get dataManager(){return this._dataManager}set dataManager(t){this._dataManager=t,this.initLoad(),this.addEventListeners()}connectedCallback(){this.isInitialized||(this.onInit(),this.isInitialized=!0)}disconnectedCallback(){this.removeEventListeners()}onInit(){this.classList.add("datatable-wrapper"),this.toolbar=document.createElement("web-dt-toolbar"),this.append(this.toolbar),this.dt=document.createElement("web-data-table"),this.append(this.dt),this.rowMenu=document.createElement("web-context-menu"),this.append(this.rowMenu),this.modalEditForm=document.createElement("web-modal-edit-form"),this.append(this.modalEditForm)}addEventListeners(){this.listeners=[{eventName:"filter",target:this.dataManager.events.element,handler:this.onFilter.bind(this)},{eventName:"sort",target:this.dataManager.events.element,handler:this.onSort.bind(this)},{eventName:"page",target:this.dataManager.events.element,handler:this.onPage.bind(this)},{eventName:"scroll",target:this.dataManager.events.element,handler:this.onScroll.bind(this)},{eventName:"create",target:this.modalEditForm,handler:this.onCreate.bind(this)},{eventName:"update",target:this.modalEditForm,handler:this.onUpdate.bind(this)},{eventName:"createAction",target:this.toolbar,handler:this.createAction.bind(this)},{eventName:"columnsChanged",target:this.toolbar,handler:this.onColumnsChanged.bind(this)}],this.listeners.forEach(t=>{t.target.addEventListener(t.eventName,t.handler)})}removeEventListeners(){this.listeners.forEach(t=>{t.target.removeEventListener(t.eventName,t.handler)})}initLoad(){const t=this.dataManager.columns.find(t=>t.name===i.ColumnModelGenerator.actionColumn.name);t&&(t.cellTemplate=new r(this.onRowMenuClick.bind(this)),t.headerCellTemplate=new i.HeaderActionRenderer),this.dt.table=this.dataManager,this.initRowMenu(),this.rowMenu.menu=this.actionMenu,this.dataManager.settings.initLoad&&this.dataManager.loadItems(),this.toolbar.table=this.dataManager,this.toolbar.createAction=this.dataManager.settings.crud,this.toolbar.globalFilter=this.dataManager.settings.globalFilter,this.toolbar.exportAction=this.dataManager.settings.exportAction,this.toolbar.clearAllFiltersAction=this.dataManager.settings.clearAllFiltersAction,this.toolbar.columnToggleAction=this.dataManager.settings.columnToggleAction,this.modalEditForm.dynElements=o.createDynamicFormElements(this.dataManager),this.modalEditForm.saveMessage=this.dataManager.messages.save,this.modalEditForm.closeMessage=this.dataManager.messages.close,this.modalEditForm.getViewDataFunc=()=>o.getRowViewData(this.dataManager)}onFilter(){this.dataManager.pager.current=1,this.dataManager.settings.virtualScroll&&(this.dt.setOffsetY(0),this.dataManager.pagerCache={},this.dataManager.clear()),this.dataManager.loadItems()}onSort(){this.dataManager.settings.virtualScroll&&(this.dt.setOffsetY(0),this.dataManager.pager.current=1,this.dataManager.pagerCache={},this.dataManager.clear()),this.dataManager.loadItems()}onPage(){this.dataManager.loadItems()}onScroll(){this.rowMenu.hide()}onRowMenuClick(t,e){const{cell:s}=t,n=s.row,{left:a,top:r}=i.EventHelper.getRowPosition(e,this.dataManager.settings.virtualScroll);this.rowMenuBeforeOpen(n),this.rowMenu.show({originalEvent:e,data:n,left:a,top:r})}rowMenuBeforeOpen(t){const e=this.dataManager.rowChanged(t);let s=this.actionMenu.findIndex(t=>t.id===this.dataManager.messages.revertChanges);if(s>-1&&(this.actionMenu[s].disabled=!e),s=this.actionMenu.findIndex(t=>t.id===this.dataManager.messages.save),s>-1){const i=this.dataManager.rowIsValid(t);this.actionMenu[s].disabled=!e||!i}this.rowMenu.menu=this.actionMenu}initRowMenu(){this.dataManager.settings.singleRowView&&this.actionMenu.push({id:this.dataManager.messages.titleDetailView,label:this.dataManager.messages.titleDetailView,icon:["dt-icon","dt-icon-rightwards"],command:t=>this.viewAction(t)}),this.dataManager.settings.crud&&this.actionMenu.push({id:this.dataManager.messages.titleUpdate,label:this.dataManager.messages.titleUpdate,icon:["dt-icon","dt-icon-pencil"],command:t=>this.updateAction(t)},{id:this.dataManager.messages.refresh,label:this.dataManager.messages.refresh,icon:["dt-icon","dt-icon-refresh"],command:t=>this.dataManager.refreshRow(t)},{id:this.dataManager.messages.revertChanges,label:this.dataManager.messages.revertChanges,icon:["dt-icon","dt-icon-return"],command:t=>this.dataManager.revertRowChanges(t),disabled:!0},{id:this.dataManager.messages.save,label:this.dataManager.messages.save,icon:["dt-icon","dt-icon-ok"],command:t=>this.dataManager.update(t),disabled:!0},{id:this.dataManager.messages.delete,label:this.dataManager.messages.delete,icon:["dt-icon","dt-icon-remove"],command:t=>confirm("Delete ?")?this.dataManager.delete(t):null},{id:this.dataManager.messages.duplicate,label:this.dataManager.messages.duplicate,icon:["dt-icon","dt-icon-plus"],command:t=>this.duplicateAction(t)})}createAction(){this.dataManager.item=new i.Row({}),this.modalEditForm.item=this.dataManager.item,this.modalEditForm.modalTitle=this.dataManager.messages.titleCreate,this.modalEditForm.create()}viewAction(t){this.dataManager.item=t,this.modalEditForm.item=this.dataManager.item,this.modalEditForm.modalTitle=this.dataManager.messages.titleDetailView,this.modalEditForm.view()}updateAction(t){this.dataManager.item=t,this.modalEditForm.item=this.dataManager.item,this.modalEditForm.modalTitle=this.dataManager.messages.titleUpdate,this.modalEditForm.update()}duplicateAction(t){this.dataManager.item=t.clone(),this.modalEditForm.item=this.dataManager.item,this.modalEditForm.modalTitle=this.dataManager.messages.titleCreate,this.modalEditForm.update(!0)}onCreate(t){this.dataManager.create(t.detail)}onUpdate(t){this.dataManager.update(t.detail)}onColumnsChanged(){this.dt.columnsChanged()}}customElements.define("web-crud-table",l)},71:function(t,e,s){"use strict";s.d(e,"a",(function(){return i}));class i{constructor(t){this.element=t,this.listeners=[],this.addEventListeners()}addEventListeners(){this.listeners=[{eventName:"dragenter",target:this.element,handler:this.onDragEnter.bind(this)},{eventName:"dragover",target:this.element,handler:this.onDragOver.bind(this)},{eventName:"dragleave",target:this.element,handler:this.onDragLeave.bind(this)},{eventName:"drop",target:this.element,handler:this.onDrop.bind(this)}],this.listeners.forEach(t=>{t.target.addEventListener(t.eventName,t.handler)})}removeEventListeners(){this.listeners.forEach(t=>{t.target.removeEventListener(t.eventName,t.handler)})}onDragEnter(t){t.preventDefault()}onDragOver(t){t.preventDefault()}onDragLeave(t){t.preventDefault()}onDrop(t){t.preventDefault();const e=this.dragElementEvent.event.target.parentElement,s=Math.max(0,this.getNumberPosition(t.target));let i;i=e===this.element?{previousIndex:this.dragElementEvent.index,currentIndex:s,type:"reorder"}:{previousIndex:this.dragElementEvent.index,currentIndex:s,type:"move"},this.element.dispatchEvent(new CustomEvent("dropElement",{detail:i}))}getNumberPosition(t){const e=this.dragElementEvent.event.target.parentElement,s=this.element;if(t===e)return e.children?e.children.length:0;if(t===s)return s.children?s.children.length:0;let i=0;for(;t=t.previousSibling;)i++;return i-1}}},74:function(t,e,s){"use strict";var i=s(68),n=s(0);class a extends HTMLElement{constructor(){super(),this._menu=[],this.listeners=[]}get menu(){return this._menu}set menu(t){this._menu=t,this.render()}connectedCallback(){this.isInitialized||(this.onInit(),this.isInitialized=!0)}disconnectedCallback(){this.dropdown.removeEventListeners(),this.removeEventListeners()}onInit(){this.listMenu=document.createElement("ul"),this.append(this.listMenu),this.classList.add("dt-context-menu"),this.dropdown=new i.a(this),this.addEventListeners()}addEventListeners(){this.listeners=[{eventName:"open",target:this,handler:this.onOpenChange.bind(this)},{eventName:"resize",target:window,handler:this.onWindowResize.bind(this)},{eventName:"click",target:this.listMenu,handler:this.onClickListMenu.bind(this)}],this.listeners.forEach(t=>{t.target.addEventListener(t.eventName,t.handler)})}removeEventListeners(){this.listeners.forEach(t=>{t.target.removeEventListener(t.eventName,t.handler)})}onWindowResize(){this.dropdown.closeDropdown()}getPositionMenu(t,e){const{height:s,width:i}=this.getHiddenElementOuterSizes(this);return t+i-window.pageXOffset>window.innerWidth&&(t-=i),e+s-window.pageYOffset>window.innerHeight&&(e-=s),t<document.body.scrollLeft&&(t=document.body.scrollLeft),e<document.body.scrollTop&&(e=document.body.scrollTop),{left:t,top:e}}getHiddenElementOuterSizes(t){if(t.offsetParent)return{height:t.offsetHeight,width:t.offsetWidth};t.style.visibility="hidden",t.style.display="block";const e=t.offsetHeight,s=t.offsetWidth;return t.style.display="none",t.style.visibility="visible",{height:e,width:s}}show(t){let e;this.eventArgs=t,Object(n.isBlank)(t.left)||Object(n.isBlank)(t.top)?e=this.getPositionMenu(t.originalEvent.pageX+1,t.originalEvent.pageY+1):(e=this.getPositionMenu(t.left,t.top),this.dropdown.selectContainerClicked=!0),t.originalEvent.preventDefault(),this.top===e.top&&this.left===e.left?this.dropdown.toggleDropdown():(this.top=e.top,this.left=e.left,this.dropdown.closeDropdown(),this.dropdown.openDropdown())}hide(){this.dropdown.closeDropdown()}itemClick(t,e){e.disabled?t.preventDefault():(e.url||t.preventDefault(),e.command&&e.command(this.eventArgs.data),this.dropdown.closeDropdown())}updateStyles(){this.style.left=this.left+"px",this.style.top=this.top+"px",this.style.display=this.dropdown.isOpen&&this.menu.length>0?"block":"none"}onOpenChange(){this.updateStyles()}render(){const t=this.createListContent();this.listMenu.textContent="",this.listMenu.append(...t),this.updateStyles()}createListContent(){const t=[];return this.menu.forEach((e,s)=>{const i=document.createElement("li");e.disabled&&i.classList.add("disabled");const n=document.createElement("a");n.href=e.url||"#",n.textContent=e.label,n.dataset.id=s.toString(),i.append(n);const a=document.createElement("span");a.classList.add("context-menu-sep"),n.prepend(a);const r=document.createElement("i");e.icon&&r.classList.add(...e.icon),n.prepend(r),t.push(i)}),t}getDataId(t){const e="A"===t.tagName?t:t.closest("a");return e&&e.dataset.id?e.dataset.id:null}onClickListMenu(t){const e=this.getDataId(t.target);if(null!=e){const s=parseInt(e,10);this.itemClick(t,this.menu[s])}}}customElements.define("web-context-menu",a)},75:function(t,e){},77:function(t,e){},78:function(t,e,s){"use strict";s.d(e,"a",(function(){return a}));var i=s(0),n=s(71);class a{constructor(t,e){this.droppables=[],this.listeners=[],this.draggableElements=[],this.registerDroppableElements(t),this.registerDraggableElements(e)}destroy(){this.removeEventListeners(),this.droppables.forEach(t=>{t.removeEventListeners()})}registerDroppableElements(t){const e=[];t.forEach(t=>{this.droppables.push(new n.a(t)),e.push({eventName:"dropElement",target:t,handler:e=>{this.onDrop(e.detail,t)}})}),e.forEach(t=>{t.target.addEventListener(t.eventName,t.handler)}),this.listeners=[...this.listeners,...e]}registerDraggableElements(t){const e=[];t.forEach(t=>{t.draggable=!0,e.push({eventName:"dragstart",target:t,handler:this.onDragStart.bind(this)}),this.draggableElements.push(t)}),this.draggableElements.forEach((t,e)=>t.dataset.index=e.toString()),e.forEach(t=>{t.target.addEventListener(t.eventName,t.handler)}),this.listeners=[...this.listeners,...e]}removeEventListeners(){this.listeners.forEach(t=>{t.target.removeEventListener(t.eventName,t.handler)})}onDragStart(t){const e=t.target.dataset.index;t.dataTransfer.setData("text",e),t.dataTransfer.effectAllowed="move";const s={event:t,index:parseInt(e,10)};this.droppables.forEach(t=>t.dragElementEvent=s),this.source=t.target.parentElement}onDrop(t,e){const s=Array.from(this.source.children),n=Array.from(e.children);"reorder"===t.type?(Object(i.arrayMove)(n,t.previousIndex,t.currentIndex),n.forEach((t,e)=>t.dataset.index=e.toString()),e.append(...n)):(Object(i.arrayTransfer)(s,n,t.previousIndex,t.currentIndex),s.forEach((t,e)=>t.dataset.index=e.toString()),n.forEach((t,e)=>t.dataset.index=e.toString()),this.source.append(...s),e.append(...n)),e.dispatchEvent(new CustomEvent("droppableElementChange"))}}},79:function(t,e,s){"use strict";var i=s(0);class n extends HTMLElement{constructor(){super(),this.headerKeyMessage="Key",this.headerValueMessage="Value",this.reverse=!0,this.listeners=[]}get data(){return this._data}set data(t){this._data=t,this.renderRows()}connectedCallback(){this.isInitialized||(this.onInit(),this.isInitialized=!0)}disconnectedCallback(){this.removeEventListeners()}onInit(){this.renderTable(),this.addEventListeners()}addEventListeners(){this.listeners=[{eventName:"click",target:this.headerKey,handler:this.onClickHeaderKey.bind(this)},{eventName:"click",target:this.headerValue,handler:this.onClickHeaderValue.bind(this)}],this.listeners.forEach(t=>{t.target.addEventListener(t.eventName,t.handler)})}removeEventListeners(){this.listeners.forEach(t=>{t.target.removeEventListener(t.eventName,t.handler)})}renderTable(){const t=document.createElement("table");t.classList.add("dt-detail-view");const e=document.createElement("thead");t.append(e);const s=document.createElement("tr");e.append(s);const i=document.createElement("th");i.textContent="№",s.append(i),this.headerKey=document.createElement("th"),this.headerKey.classList.add("sortable"),this.headerKey.textContent=this.headerKeyMessage,s.append(this.headerKey),this.headerValue=document.createElement("th"),this.headerValue.classList.add("sortable"),this.headerValue.textContent=this.headerValueMessage,s.append(this.headerValue),this.tbody=document.createElement("tbody"),t.append(this.tbody),this.append(t)}renderRows(){const t=this.orderedData?this.orderedData:this.data,e=[];t.forEach((t,s)=>{const i=document.createElement("tr"),n=document.createElement("td");n.textContent=(s+1).toString(),i.append(n);const a=document.createElement("td");a.textContent=t.key,i.append(a);const r=document.createElement("td");r.textContent=t.value,i.append(r),e.push(i)}),this.tbody.innerHTML="",this.tbody.append(...e)}onClickHeaderKey(){this.setOrder("key"),this.renderRows(),this.updateStyles()}onClickHeaderValue(){this.setOrder("value"),this.renderRows(),this.updateStyles()}setOrder(t){this.order===t&&(this.reverse=!this.reverse),this.order=t,this.orderedData=this.orderBy(this.data,this.order,this.reverse)}orderBy(t,e,s){return t&&e?(t.sort((t,s)=>t[e]>s[e]?1:t[e]<s[e]?-1:0),!1===s?t.reverse():t):t}isOrder(t){return this.order===t&&this.reverse}isOrderReverse(t){return this.order===t&&!this.reverse}updateStyles(){Object(i.toggleClass)(this.headerKey,"asc",this.isOrder("key")),Object(i.toggleClass)(this.headerKey,"desc",this.isOrderReverse("key")),Object(i.toggleClass)(this.headerValue,"asc",this.isOrder("value")),Object(i.toggleClass)(this.headerValue,"desc",this.isOrderReverse("value"))}}customElements.define("web-row-view",n)},80:function(t,e){},82:function(t,e,s){"use strict";s(74),s(75)},83:function(t,e,s){"use strict";var i=s(90);s.d(e,"CdtSettings",(function(){return i.a}));var n=s(122);s.d(e,"DataManager",(function(){return n.a}));s(123),s(127)},85:function(t,e,s){"use strict";s(71);var i=s(77);s.o(i,"DragDrop")&&s.d(e,"DragDrop",(function(){return i.DragDrop}));var n=s(78);s.d(e,"DragDrop",(function(){return n.a}))},86:function(t,e,s){"use strict";s(79),s(80)},89:function(t,e,s){"use strict";s.d(e,"a",(function(){return i.a}));s(12);var i=s(73);s(86);class n extends HTMLElement{constructor(){super(),this.item={},this.listeners=[]}set dynElements(t){this.dynamicForm.dynElements=t}set modalTitle(t){this.modalEditFormTitle.textContent=t}set saveMessage(t){this.modalEditFormSave.textContent=t}set closeMessage(t){this.modalEditFormClose.textContent=t}connectedCallback(){this.isInitialized||(this.onInit(),this.isInitialized=!0)}disconnectedCallback(){this.removeEventListeners()}onInit(){const t=(~~(1e3*Math.random())).toString(),e=document.createElement("template");e.innerHTML=function(t){return`\n  <web-modal>\n    <template select="app-modal-header">\n      <span id="modalEditFormTitle${t}">Modal</span>\n    </template>\n    <template select="app-modal-body">\n      <web-dynamic-form></web-dynamic-form>\n      <web-row-view></web-row-view>\n    </template>\n    <template select="app-modal-footer">\n      <button class="dt-button" id="modalEditFormSave${t}">Save</button>\n      <button class="dt-button dt-green" id="modalEditFormClose${t}" style="float: right;">Close</button>\n    </ng-container>\n    </template>\n  </web-modal>\n  `}(t),this.append(e.content.cloneNode(!0)),this.modalEditFormTitle=this.querySelector("#modalEditFormTitle"+t),this.modalEditFormSave=this.querySelector("#modalEditFormSave"+t),this.modalEditFormClose=this.querySelector("#modalEditFormClose"+t),this.modal=this.querySelector("web-modal"),this.dynamicForm=this.querySelector("web-dynamic-form"),this.rowView=this.querySelector("web-row-view"),this.dynamicForm.style.display="none",this.rowView.style.display="none",this.addEventListeners()}addEventListeners(){this.listeners=[{eventName:"valid",target:this.dynamicForm,handler:this.onFormValid.bind(this)},{eventName:"click",target:this.modalEditFormSave,handler:this.onClickSave.bind(this)},{eventName:"click",target:this.modalEditFormClose,handler:this.onClickClose.bind(this)}],this.listeners.forEach(t=>{t.target.addEventListener(t.eventName,t.handler)})}removeEventListeners(){this.listeners.forEach(t=>{t.target.removeEventListener(t.eventName,t.handler)})}onClickSave(){this.isNewItem?this.dispatchEvent(new CustomEvent("create",{detail:this.item})):this.dispatchEvent(new CustomEvent("update",{detail:this.item})),this.modal.hide()}onClickClose(){this.modal.hide()}onFormValid(t){this.modalEditFormSave.disabled=!t.detail}create(){this.rowView.style.display="none",this.dynamicForm.style.display="block",this.modalEditFormSave.style.visibility="visible",this.item={},this.dynamicForm.item=this.item,this.isNewItem=!0,this.modal.show()}update(t=!1){this.rowView.style.display="none",this.dynamicForm.style.display="block",this.modalEditFormSave.style.visibility="visible",this.dynamicForm.item=this.item,this.isNewItem=t,this.modal.show()}view(){this.rowView.style.display="block",this.dynamicForm.style.display="none",this.modalEditFormSave.style.visibility="hidden",this.rowView.data=this.getViewDataFunc?this.getViewDataFunc():this.getData(),this.modal.show()}getData(){return Object.keys(this.item).map(t=>({key:t,value:this.item[t]}))}}customElements.define("web-modal-edit-form",n)},90:function(t,e,s){"use strict";s.d(e,"a",(function(){return n}));var i=s(65);class n extends i.Settings{constructor(t){super(t),this.initLoad=!0,this.singleRowView=!0,this.clearAllFiltersIcon=!0,Object.assign(this,t)}}}}]);